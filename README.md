## Отчет по второму практическому заданию курса "Имитационное моделирование в исследовании и разработке информационных систем"

### Постановка задачи
Моделирование работы магазина самообслуживания (вариант 4).

Покупатель входит в магазин (интервал времени между входящими — случайная величина с рапределением D<sub>enter</sub>), набирает в тележку n<sub>i</sub> единиц товара (распределение D<sub>num</sub>), тратя на это время t<sub>i</sub> (распределение D<sub>time</sub>, среднее зависит от n<sub>i</sub>), и встаёт в очередь к одной из касс. Общее число касс k. Время обслуживания покупателя в кассе задаётся случайной величиной с распределением D<sub>pay</sub>, среднее значение зависит от числа покупок. Правила выбора кассы могут быть различными (см. ниже).

Требуется построить модель, отражающую состояние очередей к кассам и общее число покупателей в торговом зале. Задать распределения D<sub>enter</sub>, D<sub>num</sub>, D<sub>time</sub>, D<sub>pay</sub> на основе интуитивных предположений и / или наблюдений, задать параметры распределений (по согласованию с преподавателем).

Провести серию экспериментов с моделью и определить зависимость среднего времени ожидания покупателя в очереди к кассе от числа касс и правил выбора кассы. Ещё вариант: время ожидания, делённое на число покупок.

Возможные правила выбора кассы (список может быть дополнен по усмотрению студента,  исполнителю задания не требуется выбирать  все пункты, объём исследования берётся по  согласованию с преподавателем):
* покупатель случайно выбирает кассу (задать распределение);
* покупатель идёт к кассе с очередью наименьшей длины (в людях);
* есть кассы для числа покупок «не более чем», покупатели строго следуют указанному ограничению (предусмотреть исследование числа таких касс);
* одна очередь на все кассы.

Дополнительно: провести исследование, каково должно быть  минимальное число касс для того, чтобы время ожидания было в пределах допустимого (оптимизация в пользу магазина).

### Распределения
Зададим следующие распраделения, необходимые для решения задачи:
* Интервал между входящими покупателями — случайная величина, заданная экспоненциальным распределением D<sub>enter</sub> (известно из курса теории вероятностей) с параметром 0.30.
* Количество покупок — случайная величина, заданная гамма-распределением D<sub>num</sub> с параметрами (12.00, 1.00).
* Время совершения покупок (в минутах) и время обслуживания покупателя (в секундах) заданы нормальным распределением (D<sub>time</sub> и D<sub>pay</sub>) с параметрами (3.00, 0.20) и (5.00, 0.20) соответственно. Выбор в пользу нормального распределения сделан в силу того, что все в среднем тратят одинаковое время.

### Замечания по реализации
* Для реализации использованы Python 2.7.9 и [SimPy](https://simpy.readthedocs.io/) — фреймворк процессо-ориентированной дискретно-событийной системы моделирования<sup>[wiki](https://ru.wikipedia.org/wiki/SimPy)</sup>.
* Наиболее подробные комментарии в коде даны в файде single.py. За дополнительными пояснениями можно обращаться к ним.
* Для замера времени с различным количеством касс (от 20 до 40) можно использовать скрипт measuring.sh, передав в качестве аргумента имя одного из сценариев (\*.py файлов).
* Различные варианты реализации по файлам:
  * `single.py` — одна очередь на все кассы;
  * `min.py` — выбор кассы с минимальной очередью (в людях);
  * `rand.py` — выбор кассы случайным образом.

### Результаты
Была проведена серия опытов, в которых варьировались стратегия и количество касс с целью посчитать среднее время ожидания. В итоге замеров были получены следующие результаты:

|    Количество касс    |    Одна очерель   |    Минимальная очередь    |    Случайная очередь  |
|    ---:   |    ---:   |    ---:   |    ---:   |
|   20  |   11  |   16  |   256 |
|   21  |   5   |   9   |   179 |
|   22  |   3   |   5   |   134 |
|   23  |   2   |   4   |   111 |
|   24  |   1   |   2   |   94  |
|   25  |   1   |   1   |   80  |
|   26  |   1   |   1   |   70  |
|   27  |   1   |   1   |   62  |
|   28  |   1   |   1   |   57  |
|   29  |   1   |   1   |   51  |
|   30  |   1   |   1   |   48  |
|   31  |   1   |   1   |   43  |
|   32  |   1   |   1   |   41  |
|   33  |   0   |   1   |   38  |
|   34  |   0   |   0   |   35  |
|   35  |   0   |   0   |   33  |
|   36  |   0   |   0   |   31  |
|   37  |   0   |   0   |   30  |
|   38  |   0   |   0   |   29  |
|   39  |   0   |   0   |   28  |
|   40  |   0   |   0   |   26  |



### Вывод
Наиболее удачная стратегия, позволяющая максимально сократить время ожидания (а значит увеличить пропускную способность магазина) при числе касс до 27 — это организовать одну очередь для всех касс. Если число касс больше 27, можно также организовать для каждой кассы отдельную очередь, и направлять покупателя к кассе с минимальной очередью. Самостоятельный выбор кассы покупателем (случайным образом) является наихудшим вариантом.
